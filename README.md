# Fibonacci API

フィボナッチ数列の第n項を算出・返却するREST APIです。

## 1. 概要
指定された整数 `n` に対して、フィボナッチ数列の第n項を計算します。
コードの保守性とパフォーマンスを自分なりに意識した設計を行いました。

## 2. 公開エンドポイントURL
実際に動作するサーバーを構築済みです。以下のURLより動作確認が可能です。

- **URL**: `https://fib-api-ascx.onrender.com/fib?n=100`
- **動作確認例**: `n` に 1 以上の整数を指定して GET リクエストを送信してください。

## 3. ディレクトリ構成
本リポジトリは、Render へのデプロイを考慮した以下の構成となっています。
- `main.py`: APIサーバー本体（FastAPI）。バリデーション、計算ロジック、タイムアウト制御を実装。
- `test_main.py`: `pytest` を用いたユニットテスト。正常系、異常系、およびメモ化による高速化を検証。
- `requirements.txt`: 動作に必要な依存ライブラリ一覧（fastapi, uvicorn, pytest, httpx）。
- `README.md`: 本ドキュメント。

## 4. こだわったポイント
- **保守運用性の考慮**: 計算ロジックとバリデーションを分離。将来的なアルゴリズムの変更や機能拡張（他の計算機能の追加など）が容易な構造にしました。
- **パフォーマンス最適化**: `@lru_cache` を活用。一度計算した結果はメモリ上に保持し、2回目以降の同一リクエストには計算をスキップして即時にレスポンスを返します。
- **堅牢なエラーハンドリング**: 文字列、負の数、小数、および計算負荷を考慮した上限値（100,000）超えの入力に対し、適切な HTTP 400 エラーとエラーメッセージを返却します。
- **タイムアウトの実装**: `asyncio.wait_for` を用い、1分を超える過度な計算には 504 Gateway Timeout を返してサーバーリソースの枯渇を防ぎます。

## 5. レスポンス形式
- **成功時 (HTTP 200)**:
  ```json
  {"status": 200, "result": 354224848179261915075}
- **失敗時 (HTTP 400)**:
  ```json
  {"status": 400, "message": "Bad request. n must be a positive integer."}

  
  
